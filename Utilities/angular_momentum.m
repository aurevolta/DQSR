function [ L,dLddx ] = angular_momentum(II,a,da,J)
% computes the angular momentum and its jacobian of the body

% SPDX-License-Identifier: Apache-2.0
% 2016 Aureliano Rivolta

%%

R=q2dcm(a(1:4))';
QP=crossqp(a(1:4))';
QM=crossqm(a(1:4))';
CROSSR2=4*QM(1:3,:)*crossqm(a(5:8));

% angular momentum as function of dq time variation
dLdda=[(R*diag(II(1:3))*2*QP(1:3,:)-II(4)*CROSSR2*crossqmt(a(5:8))),-II(4)*CROSSR2*QM];

% angular momentum of body i
L=dLdda*da;

% angular momentum as function of free variables through use of jacobian
dLddx=dLdda*J;

end

% function [J,dJ] = ang_mom_jacobians(II,a,da)
% %ANG_MOM_JACOBIANS
% %    [J,DJ] = ANG_MOM_JACOBIANS(IN1,IN2,IN3)
% 
% %    This function was generated by the Symbolic Math Toolbox version 6.3.
% %    09-Feb-2017 11:10:54
% 
% II1 = II(1,:);
% II2 = II(2,:);
% II3 = II(3,:);
% II4 = II(4,:);
% dq1 = da(1,:);
% dq2 = da(2,:);
% dq3 = da(3,:);
% dq4 = da(4,:);
% dt1 = da(5,:);
% dt2 = da(6,:);
% dt3 = da(7,:);
% dt4 = da(8,:);
% q1 = a(1,:);
% q2 = a(2,:);
% q3 = a(3,:);
% q4 = a(4,:);
% t1 = a(5,:);
% t2 = a(6,:);
% t3 = a(7,:);
% t4 = a(8,:);
% t6 = q4.^2;
% t7 = q3.^2;
% t8 = q2.^2;
% t9 = q1.^2;
% t10 = t1.^2;
% t11 = t2.^2;
% t12 = t3.^2;
% t13 = t4.^2;
% t14 = II4.*q3.*t11.*4.0;
% t15 = II4.*q4.*t11.*4.0;
% t16 = II4.*q4.*t12.*4.0;
% t17 = II4.*q4.*t13.*4.0;
% t18 = II4.*q3.*t1.*t2.*8.0;
% t19 = II3.*q1.*q2.*q3.*4.0;
% t20 = II4.*q1.*t13.*4.0;
% t21 = II4.*q2.*t10.*4.0;
% t22 = II4.*q2.*t11.*4.0;
% t23 = II4.*q2.*t13.*4.0;
% t24 = II4.*q1.*t3.*t4.*8.0;
% t25 = II3.*q1.*q3.*q4.*4.0;
% t26 = t3.*t7;
% t27 = q1.*q3.*t1.*2.0;
% t28 = q2.*q3.*t2.*2.0;
% t29 = q3.*q4.*t4.*2.0;
% t70 = t3.*t9;
% t71 = t3.*t8;
% t72 = t3.*t6;
% t30 = t26+t27+t28+t29-t70-t71-t72;
% t31 = II4.*t30.*4.0;
% t32 = t4.*t6;
% t33 = q1.*q4.*t1.*2.0;
% t34 = q2.*q4.*t2.*2.0;
% t35 = q3.*q4.*t3.*2.0;
% t67 = t4.*t9;
% t68 = t4.*t8;
% t69 = t4.*t7;
% t36 = t32+t33+t34+t35-t67-t68-t69;
% t37 = t1.*t9;
% t38 = q1.*q2.*t2.*2.0;
% t39 = q1.*q3.*t3.*2.0;
% t40 = q1.*q4.*t4.*2.0;
% t64 = t1.*t8;
% t65 = t1.*t7;
% t66 = t1.*t6;
% t41 = t37+t38+t39+t40-t64-t65-t66;
% t42 = II4.*t41.*4.0;
% t43 = t2.*t8;
% t44 = q1.*q2.*t1.*2.0;
% t45 = q2.*q3.*t3.*2.0;
% t46 = q2.*q4.*t4.*2.0;
% t60 = t2.*t9;
% t61 = t2.*t7;
% t62 = t2.*t6;
% t47 = t43+t44+t45+t46-t60-t61-t62;
% t48 = II4.*q1.*t12.*4.0;
% t49 = II4.*q3.*t2.*t4.*8.0;
% t50 = II2.*q2.*q3.*q4.*4.0;
% t51 = II4.*q4.*t10.*4.0;
% t52 = II4.*q1.*t2.*t3.*8.0;
% t53 = II1.*q1.*q2.*q3.*4.0;
% t54 = II4.*q3.*t12.*4.0;
% t55 = II4.*q3.*t13.*4.0;
% t56 = II4.*q1.*t2.*t4.*8.0;
% t57 = II4.*q2.*t1.*t4.*8.0;
% t58 = II1.*q1.*q2.*q4.*4.0;
% t59 = II2.*q1.*q2.*q4.*4.0;
% t63 = II4.*t47.*4.0;
% J = reshape([t15+t16+t17+t18+t19+II1.*q4.*t6.*2.0-II1.*q4.*t7.*2.0-II1.*q4.*t8.*2.0+II2.*q4.*t7.*4.0+II1.*q4.*t9.*2.0+II3.*q4.*t8.*4.0-II4.*q4.*t10.*4.0+II4.*q1.*t1.*t4.*8.0-II4.*q2.*t1.*t3.*8.0-II2.*q1.*q2.*q3.*4.0,t14+t54+t55+t57+t58+II1.*q3.*t6.*4.0-II2.*q3.*t6.*2.0+II2.*q3.*t7.*2.0-II2.*q3.*t8.*2.0+II2.*q3.*t9.*2.0+II3.*q3.*t8.*4.0-II4.*q3.*t10.*4.0+II4.*q1.*t1.*t3.*8.0-II4.*q4.*t1.*t2.*8.0-II3.*q1.*q2.*q4.*4.0,t21-t22-t23-II1.*q2.*t6.*4.0-II2.*q2.*t7.*4.0+II3.*q2.*t6.*2.0+II3.*q2.*t7.*2.0-II3.*q2.*t8.*2.0-II3.*q2.*t9.*2.0-II4.*q2.*t12.*4.0-II4.*q1.*t1.*t2.*8.0+II4.*q3.*t1.*t4.*8.0-II4.*q4.*t1.*t3.*8.0+II1.*q1.*q3.*q4.*4.0-II2.*q1.*q3.*q4.*4.0,t14+t56+t59+II1.*q3.*t6.*2.0-II1.*q3.*t7.*2.0-II2.*q3.*t6.*4.0-II1.*q3.*t8.*2.0+II1.*q3.*t9.*2.0-II3.*q3.*t9.*4.0-II4.*q3.*t10.*4.0-II4.*q3.*t12.*4.0-II4.*q3.*t13.*4.0-II4.*q2.*t2.*t3.*8.0-II4.*q4.*t1.*t2.*8.0-II3.*q1.*q2.*q4.*4.0,-t15+t16+t17-t18-t19+t51+t52+t53+II1.*q4.*t7.*4.0+II2.*q4.*t6.*2.0-II2.*q4.*t7.*2.0+II2.*q4.*t8.*2.0-II2.*q4.*t9.*2.0+II3.*q4.*t9.*4.0+II4.*q2.*t2.*t4.*8.0,t20+t48+t49+t50+II1.*q1.*t7.*4.0+II2.*q1.*t6.*4.0-II3.*q1.*t6.*2.0-II3.*q1.*t7.*2.0+II3.*q1.*t8.*2.0+II3.*q1.*t9.*2.0+II4.*q1.*t10.*4.0-II4.*q1.*t11.*4.0+II4.*q2.*t1.*t2.*8.0-II4.*q4.*t2.*t3.*8.0-II1.*q2.*q3.*q4.*4.0,t21+t22+t23+t24+t25-II1.*q2.*t6.*2.0+II1.*q2.*t7.*2.0+II1.*q2.*t8.*2.0+II3.*q2.*t6.*4.0-II1.*q2.*t9.*2.0+II2.*q2.*t9.*4.0-II4.*q2.*t12.*4.0+II4.*q3.*t2.*t3.*8.0-II4.*q4.*t1.*t3.*8.0-II2.*q1.*q3.*q4.*4.0,-t20+t48+II2.*q1.*t6.*2.0-II1.*q1.*t8.*4.0-II2.*q1.*t7.*2.0-II3.*q1.*t6.*4.0+II2.*q1.*t8.*2.0-II2.*q1.*t9.*2.0-II4.*q1.*t10.*4.0-II4.*q1.*t11.*4.0-II4.*q3.*t1.*t3.*8.0+II4.*q2.*t3.*t4.*8.0-II4.*q4.*t2.*t3.*8.0-II1.*q2.*q3.*q4.*4.0+II3.*q2.*q3.*q4.*4.0,t15-t16+t17+t51-t52-t53+II1.*q4.*t8.*4.0+II3.*q4.*t6.*2.0+II3.*q4.*t7.*2.0+II2.*q4.*t9.*4.0-II3.*q4.*t8.*2.0-II3.*q4.*t9.*2.0+II4.*q2.*t1.*t3.*8.0+II4.*q3.*t3.*t4.*8.0+II2.*q1.*q2.*q3.*4.0,t20+t49+t50-II1.*q1.*t6.*2.0+II1.*q1.*t7.*2.0+II1.*q1.*t8.*2.0-II1.*q1.*t9.*2.0-II2.*q1.*t8.*4.0-II3.*q1.*t7.*4.0-II4.*q1.*t10.*4.0-II4.*q1.*t11.*4.0-II4.*q1.*t12.*4.0-II4.*q2.*t3.*t4.*8.0-II4.*q4.*t1.*t4.*8.0-II3.*q2.*q3.*q4.*4.0,-t21-t22+t23+t24+t25-II2.*q2.*t6.*2.0+II2.*q2.*t7.*2.0-II1.*q2.*t9.*4.0-II2.*q2.*t8.*2.0-II3.*q2.*t7.*4.0+II2.*q2.*t9.*2.0-II4.*q2.*t12.*4.0-II4.*q3.*t1.*t4.*8.0-II4.*q4.*t2.*t4.*8.0-II1.*q1.*q3.*q4.*4.0,-t14-t54+t55-t56+t57+t58-t59-II3.*q3.*t6.*2.0-II1.*q3.*t9.*4.0-II2.*q3.*t8.*4.0-II3.*q3.*t7.*2.0+II3.*q3.*t8.*2.0+II3.*q3.*t9.*2.0-II4.*q3.*t10.*4.0-II4.*q4.*t3.*t4.*8.0,II4.*t36.*-4.0,-t31,t63,t31,II4.*t36.*-4.0,-t42,II4.*t47.*-4.0,t42,II4.*t36.*-4.0,t42,t63,t31],[3,8]);
% if nargout > 1
%     t73 = II3.*dq3.*t6.*4.0;
%     t74 = II4.*dq3.*t10.*4.0;
%     t75 = II4.*dq3.*t11.*4.0;
%     t76 = II4.*dq3.*t13.*4.0;
%     t77 = II2.*dq2.*q1.*q4.*4.0;
%     t78 = II4.*dt4.*q1.*t2.*8.0;
%     t79 = II4.*dq4.*t13.*4.0;
%     t80 = II1.*dq1.*q1.*q4.*4.0;
%     t81 = II1.*dq2.*q1.*q3.*4.0;
%     t82 = II2.*dq2.*q2.*q4.*4.0;
%     t83 = II3.*dq3.*q3.*q4.*4.0;
%     t84 = II4.*dt3.*q1.*t2.*8.0;
%     t85 = II4.*dt4.*q1.*t1.*8.0;
%     t86 = II4.*dt4.*q2.*t2.*8.0;
%     t87 = II4.*dt4.*q3.*t3.*8.0;
%     t88 = II4.*dt4.*q4.*t4.*8.0;
%     t89 = II4.*dq1.*t1.*t4.*8.0;
%     t90 = II4.*dq2.*t2.*t4.*8.0;
%     t91 = II4.*dq3.*t3.*t4.*8.0;
%     t92 = II3.*dq1.*t8.*4.0;
%     t93 = II4.*dq1.*t11.*4.0;
%     t94 = II4.*dq1.*t12.*4.0;
%     t95 = II4.*dq1.*t13.*4.0;
%     t96 = II2.*dq4.*q2.*q3.*4.0;
%     t97 = II4.*dt2.*q3.*t4.*8.0;
%     t98 = II4.*dq2.*t11.*4.0;
%     t99 = II3.*dq1.*q1.*q2.*4.0;
%     t100 = II1.*dq3.*q2.*q3.*4.0;
%     t101 = II1.*dq4.*q1.*q3.*4.0;
%     t102 = II2.*dq4.*q2.*q4.*4.0;
%     t103 = II4.*dt2.*q1.*t1.*8.0;
%     t104 = II4.*dt2.*q2.*t2.*8.0;
%     t105 = II4.*dt1.*q3.*t4.*8.0;
%     t106 = II4.*dt2.*q3.*t3.*8.0;
%     t107 = II4.*dt2.*q4.*t4.*8.0;
%     t108 = II4.*dq1.*t1.*t2.*8.0;
%     t109 = II4.*dq3.*t2.*t3.*8.0;
%     t110 = II4.*dq4.*t2.*t4.*8.0;
%     t111 = dt3.*t9;
%     t112 = dt3.*t7;
%     t113 = dt3.*t6;
%     t114 = dt4.*q1.*q2.*2.0;
%     t115 = dq1.*q3.*t1.*2.0;
%     t116 = dq1.*q4.*t2.*2.0;
%     t117 = dq2.*q3.*t2.*2.0;
%     t118 = dq3.*q3.*t3.*2.0;
%     t119 = dq4.*q3.*t4.*2.0;
%     t120 = dt4.*t8;
%     t121 = dt4.*t7;
%     t122 = dt4.*t6;
%     t123 = dt3.*q1.*q2.*2.0;
%     t124 = dq1.*q4.*t1.*2.0;
%     t125 = dq2.*q3.*t1.*2.0;
%     t126 = dq2.*q4.*t2.*2.0;
%     t127 = dq3.*q4.*t3.*2.0;
%     t128 = dq4.*q4.*t4.*2.0;
%     t129 = dt1.*t9;
%     t130 = dt1.*t8;
%     t131 = dt1.*t7;
%     t132 = dt2.*q3.*q4.*2.0;
%     t133 = dq1.*q1.*t1.*2.0;
%     t134 = dq2.*q1.*t2.*2.0;
%     t135 = dq3.*q1.*t3.*2.0;
%     t136 = dq3.*q2.*t4.*2.0;
%     t137 = dq4.*q1.*t4.*2.0;
%     t138 = dt2.*t9;
%     t139 = dt2.*t8;
%     t140 = dt2.*t6;
%     t141 = dt1.*q3.*q4.*2.0;
%     t142 = dq1.*q2.*t1.*2.0;
%     t143 = dq2.*q2.*t2.*2.0;
%     t144 = dq3.*q2.*t3.*2.0;
%     t145 = dq4.*q1.*t3.*2.0;
%     t146 = dq4.*q2.*t4.*2.0;
%     t147 = II1.*dq2.*t7.*4.0;
%     t148 = II4.*dq2.*t10.*4.0;
%     t149 = II4.*dq2.*t12.*4.0;
%     t150 = II4.*dq2.*t13.*4.0;
%     t151 = II3.*dq3.*q1.*q4.*4.0;
%     t152 = II3.*dq4.*q1.*q3.*4.0;
%     t153 = II4.*dt3.*q1.*t4.*8.0;
%     t154 = II4.*dt4.*q1.*t3.*8.0;
%     t155 = II1.*dq1.*t6.*4.0;
%     t156 = II2.*dq1.*t7.*4.0;
%     t157 = II1.*dq2.*q3.*q4.*4.0;
%     t158 = II3.*dq3.*q2.*q4.*4.0;
%     t159 = II4.*dt3.*q4.*t2.*8.0;
%     t160 = II4.*dt4.*q2.*t3.*8.0;
%     t161 = II2.*dq3.*q1.*q2.*4.0;
%     t162 = II3.*dq1.*q2.*q3.*4.0;
%     t163 = II4.*dt1.*q2.*t3.*8.0;
%     t164 = II4.*dt2.*q3.*t1.*8.0;
%     t165 = II2.*dq3.*t9.*4.0;
%     t166 = II4.*dq3.*t12.*4.0;
%     t167 = II2.*dq1.*q1.*q3.*4.0;
%     t168 = II1.*dq2.*q2.*q3.*4.0;
%     t169 = II1.*dq4.*q1.*q2.*4.0;
%     t170 = II2.*dq4.*q1.*q2.*4.0;
%     t171 = II3.*dq4.*q3.*q4.*4.0;
%     t172 = II4.*dt3.*q1.*t1.*8.0;
%     t173 = II4.*dt1.*q2.*t4.*8.0;
%     t174 = II4.*dt2.*q1.*t4.*8.0;
%     t175 = II4.*dt3.*q2.*t2.*8.0;
%     t176 = II4.*dt3.*q3.*t3.*8.0;
%     t177 = II4.*dt3.*q4.*t4.*8.0;
%     t178 = II4.*dq1.*t1.*t3.*8.0;
%     t179 = II4.*dq2.*t2.*t3.*8.0;
%     t180 = II4.*dq4.*t3.*t4.*8.0;
%     t181 = dt2.*t7;
%     t182 = dt3.*q1.*q4.*2.0;
%     t183 = dq1.*q3.*t4.*2.0;
%     t184 = dq3.*q4.*t1.*2.0;
%     t185 = dt1.*t6;
%     t186 = dt4.*q2.*q3.*2.0;
%     t187 = dq2.*q4.*t3.*2.0;
%     t188 = dq4.*q3.*t2.*2.0;
%     t189 = dt4.*t9;
%     t190 = dt1.*q2.*q3.*2.0;
%     t191 = dq1.*q2.*t3.*2.0;
%     t192 = dq3.*q1.*t2.*2.0;
%     t193 = dt3.*t8;
%     t194 = dt2.*q1.*q4.*2.0;
%     t195 = dq2.*q1.*t4.*2.0;
%     t196 = dq4.*q2.*t1.*2.0;
%     dJ = reshape([t79+t80+t81+t82+t83+t84+t85+t86+t87+t88+t89+t90+t91+t162+t164-II1.*dq4.*t6.*2.0+II1.*dq4.*t7.*2.0+II1.*dq4.*t8.*2.0-II1.*dq4.*t9.*6.0-II2.*dq4.*t8.*4.0-II3.*dq4.*t7.*4.0-II4.*dq4.*t10.*4.0-II4.*dq4.*t11.*4.0-II4.*dq4.*t12.*4.0-II1.*dq3.*q1.*q2.*4.0-II2.*dq1.*q2.*q3.*4.0+II2.*dq3.*q1.*q2.*8.0-II3.*dq2.*q1.*q3.*8.0-II3.*dq2.*q2.*q4.*4.0-II2.*dq3.*q3.*q4.*4.0+II4.*dt1.*q1.*t4.*8.0-II4.*dt1.*q4.*t1.*8.0-II4.*dt2.*q1.*t3.*8.0-II4.*dt3.*q2.*t1.*8.0,-t73-t74-t75-t76-t77-t78+t166+t167+t168+t170+t171+t172+t174+t175+t176+t177+t178+t179+t180+II2.*dq3.*t6.*2.0-II1.*dq3.*t8.*4.0-II2.*dq3.*t7.*2.0+II2.*dq3.*t8.*2.0-II2.*dq3.*t9.*6.0+II1.*dq1.*q2.*q4.*4.0-II1.*dq4.*q1.*q2.*8.0-II3.*dq1.*q2.*q4.*4.0+II3.*dq2.*q1.*q4.*8.0-II3.*dq2.*q2.*q3.*4.0-II1.*dq4.*q3.*q4.*4.0+II4.*dt1.*q1.*t3.*8.0-II4.*dt1.*q3.*t1.*8.0-II4.*dt2.*q4.*t1.*8.0+II4.*dt4.*q2.*t1.*8.0,-t98-t99-t100-t102-t103-t104-t106-t107-t108-t109-t110+t147+t148+t149+t150-t151+t152+t153-t154+II2.*dq2.*t6.*4.0-II3.*dq2.*t6.*2.0-II3.*dq2.*t7.*2.0+II3.*dq2.*t8.*2.0+II3.*dq2.*t9.*6.0+II1.*dq1.*q3.*q4.*4.0-II1.*dq4.*q1.*q3.*8.0-II2.*dq1.*q3.*q4.*4.0+II2.*dq3.*q1.*q4.*8.0+II2.*dq3.*q2.*q3.*4.0+II1.*dq4.*q2.*q4.*4.0-II4.*dt1.*q1.*t2.*8.0+II4.*dt1.*q2.*t1.*8.0-II4.*dt3.*q4.*t1.*8.0+II4.*dt4.*q3.*t1.*8.0,t73+t74+t75+t76+t77+t78+t165+t169+t173-II1.*dq3.*t6.*2.0+II1.*dq3.*t7.*2.0+II1.*dq3.*t8.*6.0-II1.*dq3.*t9.*2.0-II4.*dq3.*t12.*4.0-II2.*dq1.*q1.*q3.*4.0-II1.*dq1.*q2.*q4.*4.0-II1.*dq2.*q2.*q3.*4.0+II3.*dq1.*q1.*q3.*4.0-II2.*dq4.*q1.*q2.*8.0+II3.*dq1.*q2.*q4.*8.0-II3.*dq2.*q1.*q4.*4.0+II2.*dq4.*q3.*q4.*4.0-II3.*dq4.*q3.*q4.*4.0-II4.*dt3.*q1.*t1.*8.0-II4.*dt1.*q4.*t2.*8.0-II4.*dt2.*q2.*t3.*8.0+II4.*dt2.*q3.*t2.*8.0-II4.*dt3.*q2.*t2.*8.0-II4.*dt4.*q2.*t1.*8.0-II4.*dt3.*q3.*t3.*8.0-II4.*dt3.*q4.*t4.*8.0-II4.*dq1.*t1.*t3.*8.0-II4.*dq2.*t2.*t3.*8.0-II4.*dq4.*t3.*t4.*8.0,t79+t80+t81+t82+t83+t84+t85+t86+t87+t88+t89+t90+t91+t161+t163-II2.*dq4.*t6.*2.0+II2.*dq4.*t7.*2.0-II1.*dq4.*t9.*4.0-II2.*dq4.*t8.*6.0-II3.*dq4.*t7.*4.0+II2.*dq4.*t9.*2.0-II4.*dq4.*t10.*4.0-II4.*dq4.*t11.*4.0-II4.*dq4.*t12.*4.0-II1.*dq3.*q1.*q2.*8.0-II2.*dq1.*q2.*q3.*4.0-II3.*dq1.*q1.*q4.*4.0+II3.*dq1.*q2.*q3.*8.0-II3.*dq2.*q1.*q3.*4.0-II1.*dq3.*q3.*q4.*4.0-II4.*dt1.*q3.*t2.*8.0-II4.*dt3.*q2.*t1.*8.0+II4.*dt2.*q2.*t4.*8.0-II4.*dt2.*q4.*t2.*8.0,-t93-t94-t95-t155-t156-t157-t158-t159-t160+II3.*dq1.*t6.*2.0+II3.*dq1.*t7.*2.0-II3.*dq1.*t8.*6.0-II3.*dq1.*t9.*2.0+II4.*dq1.*t10.*4.0-II1.*dq3.*q1.*q3.*4.0+II3.*dq2.*q1.*q2.*4.0+II2.*dq3.*q1.*q3.*4.0+II1.*dq3.*q2.*q4.*8.0+II1.*dq4.*q1.*q4.*4.0+II2.*dq2.*q3.*q4.*4.0-II2.*dq4.*q1.*q4.*4.0-II2.*dq4.*q2.*q3.*8.0+II3.*dq4.*q2.*q3.*4.0+II4.*dt1.*q1.*t1.*8.0+II4.*dt1.*q2.*t2.*8.0-II4.*dt2.*q1.*t2.*8.0+II4.*dt2.*q2.*t1.*8.0+II4.*dt1.*q3.*t3.*8.0+II4.*dt1.*q4.*t4.*8.0+II4.*dt3.*q2.*t4.*8.0+II4.*dt4.*q3.*t2.*8.0+II4.*dq2.*t1.*t2.*8.0+II4.*dq3.*t1.*t3.*8.0+II4.*dq4.*t1.*t4.*8.0,t98+t99+t100+t101+t102+t103+t104+t105+t106+t107+t108+t109+t110+t151+t154+II1.*dq2.*t6.*2.0-II1.*dq2.*t7.*6.0-II2.*dq2.*t6.*4.0-II1.*dq2.*t8.*2.0+II1.*dq2.*t9.*2.0-II3.*dq2.*t9.*4.0-II4.*dq2.*t10.*4.0-II4.*dq2.*t12.*4.0-II4.*dq2.*t13.*4.0-II2.*dq1.*q1.*q2.*4.0-II1.*dq1.*q3.*q4.*4.0+II2.*dq1.*q3.*q4.*8.0-II2.*dq3.*q1.*q4.*4.0-II3.*dq4.*q1.*q3.*8.0-II3.*dq4.*q2.*q4.*4.0-II4.*dt1.*q4.*t3.*8.0-II4.*dt3.*q2.*t3.*8.0+II4.*dt3.*q3.*t2.*8.0-II4.*dt4.*q3.*t1.*8.0,t92+t93+t94+t95+t96+t97+t155+t158+t160-II2.*dq1.*t6.*2.0+II2.*dq1.*t7.*6.0-II2.*dq1.*t8.*2.0+II2.*dq1.*t9.*2.0-II4.*dq1.*t10.*4.0+II1.*dq2.*q1.*q2.*4.0-II3.*dq2.*q1.*q2.*4.0-II2.*dq3.*q1.*q3.*4.0+II1.*dq2.*q3.*q4.*8.0-II1.*dq3.*q2.*q4.*4.0-II1.*dq4.*q1.*q4.*4.0-II2.*dq2.*q3.*q4.*4.0+II3.*dq4.*q1.*q4.*4.0-II3.*dq4.*q2.*q3.*8.0-II4.*dt1.*q1.*t1.*8.0-II4.*dt1.*q2.*t2.*8.0-II4.*dt1.*q3.*t3.*8.0+II4.*dt3.*q1.*t3.*8.0-II4.*dt3.*q3.*t1.*8.0-II4.*dt1.*q4.*t4.*8.0-II4.*dt2.*q4.*t3.*8.0-II4.*dt4.*q3.*t2.*8.0-II4.*dq2.*t1.*t2.*8.0-II4.*dq3.*t1.*t3.*8.0-II4.*dq4.*t1.*t4.*8.0,t79+t80+t82+t83+t85+t86+t87+t88+t89+t90+t91+t161+t162+t163+t164-II3.*dq4.*t6.*2.0-II1.*dq4.*t9.*4.0-II2.*dq4.*t8.*4.0-II3.*dq4.*t7.*6.0+II3.*dq4.*t8.*2.0+II3.*dq4.*t9.*2.0-II4.*dq4.*t10.*4.0-II4.*dq4.*t11.*4.0-II4.*dq4.*t12.*4.0+II1.*dq2.*q1.*q3.*8.0-II1.*dq3.*q1.*q2.*4.0-II2.*dq1.*q1.*q4.*4.0-II2.*dq1.*q2.*q3.*8.0-II1.*dq2.*q2.*q4.*4.0-II3.*dq2.*q1.*q3.*4.0-II4.*dt1.*q3.*t2.*8.0-II4.*dt2.*q1.*t3.*8.0+II4.*dt3.*q3.*t4.*8.0-II4.*dt3.*q4.*t3.*8.0,t92+t93+t94+t95+t96+t97+t156+t157+t159+II1.*dq1.*t6.*6.0-II1.*dq1.*t7.*2.0-II1.*dq1.*t8.*2.0+II1.*dq1.*t9.*2.0-II4.*dq1.*t10.*4.0+II2.*dq2.*q1.*q2.*4.0-II3.*dq2.*q1.*q2.*4.0-II2.*dq3.*q1.*q3.*4.0-II1.*dq3.*q2.*q4.*4.0-II1.*dq4.*q1.*q4.*4.0+II3.*dq3.*q1.*q3.*4.0-II2.*dq2.*q3.*q4.*8.0+II3.*dq3.*q2.*q4.*8.0-II3.*dq4.*q2.*q3.*4.0-II4.*dt1.*q1.*t1.*8.0-II4.*dt1.*q2.*t2.*8.0-II4.*dt1.*q3.*t3.*8.0-II4.*dt1.*q4.*t4.*8.0-II4.*dt2.*q4.*t3.*8.0-II4.*dt3.*q2.*t4.*8.0+II4.*dt4.*q1.*t4.*8.0-II4.*dt4.*q4.*t1.*8.0-II4.*dq2.*t1.*t2.*8.0-II4.*dq3.*t1.*t3.*8.0-II4.*dq4.*t1.*t4.*8.0,-t98-t99-t100-t101-t102-t103-t104-t105-t106-t107-t108-t109-t110+t147+t148+t149+t150+t152+t153+II2.*dq2.*t6.*6.0-II2.*dq2.*t7.*2.0+II2.*dq2.*t8.*2.0-II2.*dq2.*t9.*2.0+II3.*dq2.*t9.*4.0+II1.*dq1.*q1.*q2.*4.0+II1.*dq1.*q3.*q4.*8.0-II2.*dq1.*q3.*q4.*4.0+II2.*dq3.*q1.*q4.*4.0-II3.*dq3.*q1.*q4.*8.0+II3.*dq3.*q2.*q3.*4.0+II4.*dt1.*q4.*t3.*8.0-II4.*dt3.*q4.*t1.*8.0+II4.*dt4.*q2.*t4.*8.0-II4.*dt4.*q4.*t2.*8.0,t74+t75+t76+t165-t166-t167-t168+t169-t170-t171-t172+t173-t174-t175-t176-t177-t178-t179-t180+II1.*dq3.*t8.*4.0+II3.*dq3.*t6.*6.0+II3.*dq3.*t7.*2.0-II3.*dq3.*t8.*2.0-II3.*dq3.*t9.*2.0+II1.*dq1.*q1.*q3.*4.0-II1.*dq1.*q2.*q4.*8.0+II2.*dq2.*q1.*q4.*8.0+II2.*dq2.*q2.*q3.*4.0+II3.*dq1.*q2.*q4.*4.0-II3.*dq2.*q1.*q4.*4.0-II4.*dt1.*q4.*t2.*8.0+II4.*dt2.*q4.*t1.*8.0+II4.*dt4.*q3.*t4.*8.0-II4.*dt4.*q4.*t3.*8.0,II4.*(t120+t121+t122+t123+t124+t125+t126+t127+t128+t191-dt4.*t9+dt1.*q1.*q4.*2.0-dt2.*q1.*q3.*2.0-dq1.*q1.*t4.*2.0-dq1.*q3.*t2.*2.0-dq3.*q2.*t1.*2.0+dq4.*q1.*t1.*2.0).*-4.0,II4.*(-t111+t112+t113-t114+t115+t116+t117+t118+t119+t193+t194+t196+dt1.*q1.*q3.*2.0-dq1.*q1.*t3.*2.0+dq3.*q1.*t1.*2.0-dq1.*q2.*t4.*2.0-dq2.*q4.*t1.*2.0).*-4.0,II4.*(-t138+t139+t140+t142+t143+t144+t146+t181-t182+t183+t184+dt1.*q1.*q2.*2.0+dt4.*q1.*q3.*2.0-dq1.*q1.*t2.*2.0+dq2.*q1.*t1.*2.0-dq1.*q4.*t3.*2.0-dq4.*q3.*t1.*2.0).*4.0,II4.*(t111+t112+t113+t114+t115+t116+t117+t118+t119+t195-dt3.*t8-dt1.*q2.*q4.*2.0+dt2.*q2.*q3.*2.0-dq2.*q2.*t3.*2.0-dq2.*q4.*t1.*2.0+dq3.*q2.*t2.*2.0-dq4.*q1.*t2.*2.0).*4.0,II4.*(-t120+t121+t122-t123+t124+t125+t126+t127+t128+t189+t190+t192+dt2.*q2.*q4.*2.0-dq1.*q3.*t2.*2.0-dq2.*q1.*t3.*2.0-dq2.*q2.*t4.*2.0+dq4.*q2.*t2.*2.0).*-4.0,II4.*(t129-t130+t131+t133+t134+t135+t137+t185-t186+t187+t188+dt2.*q1.*q2.*2.0+dt3.*q2.*q4.*2.0+dq1.*q2.*t2.*2.0-dq2.*q2.*t1.*2.0-dq2.*q3.*t4.*2.0-dq3.*q4.*t2.*2.0).*-4.0,II4.*(t138+t139+t140+t141+t142+t143+t144+t145+t146+t184-dt2.*t7+dt3.*q2.*q3.*2.0-dt4.*q1.*q3.*2.0-dq1.*q4.*t3.*2.0+dq2.*q3.*t3.*2.0-dq3.*q1.*t4.*2.0-dq3.*q3.*t2.*2.0).*-4.0,II4.*(t129+t130-t131-t132+t133+t134+t135+t136+t137+t185+t186+t187+dt3.*q1.*q3.*2.0+dq1.*q3.*t3.*2.0-dq3.*q3.*t1.*2.0-dq3.*q4.*t2.*2.0-dq4.*q2.*t3.*2.0).*4.0,II4.*(t120-t121+t122+t124+t126+t127+t128+t189-t190+t191+t192+dt2.*q1.*q3.*2.0+dt3.*q3.*q4.*2.0-dq2.*q1.*t3.*2.0-dq3.*q2.*t1.*2.0-dq3.*q3.*t4.*2.0+dq4.*q3.*t3.*2.0).*-4.0,II4.*(t129+t130+t131+t132+t133+t134+t135+t136+t137+t188-dt1.*t6-dt3.*q2.*q4.*2.0+dt4.*q1.*q4.*2.0+dq1.*q4.*t4.*2.0-dq2.*q3.*t4.*2.0-dq4.*q2.*t3.*2.0-dq4.*q4.*t1.*2.0).*4.0,II4.*(t138+t139-t140-t141+t142+t143+t144+t145+t146+t181+t182+t183+dt4.*q2.*q4.*2.0-dq3.*q1.*t4.*2.0-dq4.*q3.*t1.*2.0+dq2.*q4.*t4.*2.0-dq4.*q4.*t2.*2.0).*4.0,II4.*(t111+t112-t113+t115+t117+t118+t119+t193-t194+t195+t196+dt1.*q2.*q4.*2.0+dt4.*q3.*q4.*2.0-dq1.*q2.*t4.*2.0-dq4.*q1.*t2.*2.0+dq3.*q4.*t4.*2.0-dq4.*q4.*t3.*2.0).*4.0],[3,8]);
% end
% end